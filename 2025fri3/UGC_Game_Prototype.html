<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UGC設計ゲーム – プロトタイプ</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body{font-family:sans-serif;background:#f5f5f5;margin:0;padding:20px}
    h2{margin-top:40px}
    .step{background:#fff;padding:20px;border-radius:8px;max-width:800px;margin:0 auto 30px;box-shadow:0 2px 6px rgba(0,0,0,0.08)}
    .btn{padding:10px 20px;background:#2e8b57;color:#fff;border:none;border-radius:5px;cursor:pointer;margin-top:20px}
    .option{margin:8px 0}
  </style>
</head>
<body>
  <h1 style="text-align:center">UGC設計ゲーム – プロトタイプ</h1>

  <div class="step" id="step1">
    <h2>①ターゲットを選ぼう</h2>
    <label class="option"><input type="radio" name="target" value="T1"/> ケンジ（高校生）</label><br>
    <label class="option"><input type="radio" name="target" value="T2"/> アヤ（大学生デート）</label><br>
    <label class="option"><input type="radio" name="target" value="T4"/> ミサキ（子育てママ）</label><br>
    <label class="option"><input type="radio" name="target" value="T5"/> ハルキ（推し活オタク）</label><br>
    <button class="btn" onclick="nextStep(1,2)">次へ</button>
  </div>

  <div class="step" id="step2" style="display:none">
    <h2>②訴求を選ぼう（2つまで）</h2>
    <label class="option"><input type="checkbox" name="appeal" value="映え"/> 映え</label><br>
    <label class="option"><input type="checkbox" name="appeal" value="コスパ"/> コスパ</label><br>
    <label class="option"><input type="checkbox" name="appeal" value="スピード"/> スピード</label><br>
    <label class="option"><input type="checkbox" name="appeal" value="安心感"/> 安心感</label><br>
    <label class="option"><input type="checkbox" name="appeal" value="限定性"/> 限定性</label><br>
    <label class="option"><input type="checkbox" name="appeal" value="参加型"/> 参加型</label><br>
    <label class="option"><input type="checkbox" name="appeal" value="推し活"/> 推し活</label><br>
    <button class="btn" onclick="nextStep(2,3)">次へ</button>
  </div>

  <div class="step" id="step3" style="display:none">
    <h2>③媒体を選ぼう（2つまで）</h2>
    <label class="option"><input type="checkbox" name="media" value="Instagram"/> Instagram</label><br>
    <label class="option"><input type="checkbox" name="media" value="TikTok"/> TikTok</label><br>
    <label class="option"><input type="checkbox" name="media" value="X"/> X（旧Twitter）</label><br>
    <label class="option"><input type="checkbox" name="media" value="LINE"/> LINE公式</label><br>
    <label class="option"><input type="checkbox" name="media" value="Shorts"/> YouTube Shorts</label><br>
    <button class="btn" onclick="nextStep(3,4)">次へ</button>
  </div>

  <div class="step" id="step4" style="display:none">
    <h2>④クリエイティブを選ぼう</h2>
    <label class="option"><input type="radio" name="creative" value="A"/> A：ハイテンション動画（＋20%CTR）</label><br>
    <label class="option"><input type="radio" name="creative" value="B"/> B：通常写真（±0%）</label><br>
    <label class="option"><input type="radio" name="creative" value="C"/> C：長尺説明（−20%CTR）</label><br>
    <button class="btn" onclick="calculateScore()">結果を見る</button>
  </div>

  <div class="step" id="result" style="display:none"></div>

<script>
function nextStep(cur,next){
  document.getElementById('step'+cur).style.display='none';
  document.getElementById('step'+next).style.display='block';
}

// --- 基礎データ ---
const imp={Instagram:300000,TikTok:250000,X:200000,LINE:100000,Shorts:150000};
const cpc={Instagram:35,TikTok:30,X:20,LINE:15,Shorts:25};
// 基礎CTRテーブル（簡易版）：キー "T|Appeal|Media"
const baseCTR={
  'T1|映え|Instagram':1.8,'T1|映え|TikTok':2.0,'T1|コスパ|X':1.6,'T1|スピード|X':1.6,'T1|スピード|LINE':1.6,
  'T2|映え|Instagram':2.0,'T2|映え|TikTok':2.2,'T2|限定性|TikTok':2.0,'T2|参加型|TikTok':2.1,
  'T4|安心感|LINE':1.8,'T4|スピード|LINE':1.6,'T4|コスパ|LINE':1.6,
  'T5|限定性|TikTok':2.0,'T5|推し活|TikTok':2.0,'T5|参加型|TikTok':2.1
};
const creativeBonus={A:1.2,B:1.0,C:0.8};

function calculateScore(){
  // 取得
  const target=document.querySelector('input[name=target]:checked')?.value;
  const appeals=[...document.querySelectorAll('input[name=appeal]:checked')].map(e=>e.value);
  const medias=[...document.querySelectorAll('input[name=media]:checked')].map(e=>e.value);
  const creative=document.querySelector('input[name=creative]:checked')?.value;
  if(!target||appeals.length===0||medias.length===0||!creative){alert('すべて選択してください');return;}

  let totalClicks=0,totalCost=0,score=50; // 基本点
  medias.forEach(m=>{
    let bestCTR=0;
    appeals.forEach(a=>{
      const key=`${target}|${a}|${m}`;
      if(baseCTR[key] && baseCTR[key]>bestCTR) bestCTR=baseCTR[key];
    });
    if(bestCTR===0) score-=5; // マッチしなかったペナルティ
    const finalCTR=bestCTR*creativeBonus[creative];
    const clicks=imp[m]*finalCTR/100; // CTR%→クリック数
    const cost=clicks*cpc[m];
    totalClicks+=clicks;
    totalCost+=cost;
  });

  // クリック目標5000
  if(totalClicks>=5000) score+=20; else score-=10;
  // コスパ評価
  const cpa=totalCost/totalClicks;
  if(cpa<25) score+=10; else if(cpa>40) score-=5;
  // CTRボーナス
  if(creative==='A') score+=5; if(creative==='C') score-=5;

  if(score>100) score=100; if(score<0) score=0;
  let rank='C'; if(score>=85) rank='S'; else if(score>=70) rank='A'; else if(score>=55) rank='B';

  // 結果表示
  const res=document.getElementById('result');
  res.innerHTML=`<h2>結果</h2>
  <p><strong>スコア：${Math.round(score)}点</strong>（ランク：${rank}）</p>
  <p>クリック数：${Math.round(totalClicks)} / 予算：¥${Math.round(totalCost).toLocaleString()} / CPA：¥${cpa.toFixed(1)}</p>`;
  res.style.display='block';
  document.getElementById('step4').style.display='none';
}
</script>

</body>
</html>
